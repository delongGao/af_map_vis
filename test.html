<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="http://jquery-ui.googlecode.com/svn/tags/latest/ui/jquery.effects.core.js"></script>
    <script src="http://jquery-ui.googlecode.com/svn/tags/latest/ui/jquery.effects.slide.js"></script>
    <!--<script type="text/javascript" src="http://mbostock.github.com/d3/d3.js?1.29.1"></script>-->
    <style type="text/css">

        html, body, #map {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        .stations, .stations svg {
            position: absolute;
        }

        .stations svg {
            width: 60px;
            height: 20px;
            padding-right: 100px;
            font: 10px sans-serif;
        }

        .stations circle {
            fill: brown;
            stroke: black;
            stroke-width: 1.5px;
        }

    </style>
</head>
<body>
<div id="map"></div>
<script type="text/javascript">
    var data = [
            [[100,200],[200,300]],
            [[500,400],[300,700]],
            [[900,400],[300,600]],
            [[1200,500],[300,1000]],
            [[1200,500],[500,1000]]
        ];

    var data_int = data.map(function(item) { return item[0] });

//    for (var i = 0; i < 2; i++) {
        var container = d3.select("#map")
                            .append("svg")
                            .attr("length", 2000)
                            .attr("width", 2000)
                            .attr("class", "line_container");

        function linkArc(d) {
            var dx = d[1][0] - d[0][0],
                dy = d[1][1] - d[0][1],
                dr = Math.sqrt(dx * dx + dy * dy);
            return "M" + d[0][0] + "," + d[0][1] + "A" + dr + "," + dr + " 0 0,1 " + d[1][0] + "," + d[1][1];
        }

        var lineFunction = d3.svg.line()
                             .x(function(d) { return d[0]; })
                             .y(function(d) { return d[1]; })
    //                         .interpolate("monotone");
                             .interpolate("cardinal");

        var lines = container
                             .selectAll("path")
                             .data(data)
                             .enter()
                             .append("path")
                             .attr("d", linkArc)
    //                         .attr("d", lineFunction)
                             .attr("stroke", "blue")
                             .attr("stroke-width", 2)
                             .attr("fill", "none");

        var totalLength = lines.node().getTotalLength();

    //    lines.attr("stroke-dasharray", totalLength + " " + totalLength)
        lines.attr("stroke-dasharray", totalLength *3 + " " + totalLength * 5)
                .attr("stroke-dashoffset", totalLength*3)
                .transition()
                .duration(3000)
                .ease("linear")
                .attr("stroke-dashoffset", 0);
//    }


    function insertMid() {
        $.each(data, function(key, value) {
            value.splice(1,0,[(value[0][0] + value[1][0] + 200) / 2, (value[0][1] + value[1][1] + 200) / 2])
        })
    }




//    // Create the Google Map…
//    var map = new google.maps.Map(d3.select("#map").node(), {
//        zoom: 8,
//        center: new google.maps.LatLng(37.76487, -122.41948),
//        mapTypeId: google.maps.MapTypeId.TERRAIN
//    });
//
//    // Load the station data. When the data comes back, create an overlay.
//    d3.json("af_map.json", function(collection) {
//        var overlay = new google.maps.OverlayView();
//
//        // Add the container when the overlay is added to the map.
//        overlay.onAdd = function() {
//            var layer = d3.select(this.getPanes().overlayLayer).append("svg")
//                    .attr("class", "stations");
//            var g = layer.append("g");
//
//            // Draw each marker as a separate SVG element.
//            // We could use a single SVG, but what size would it have?
//            overlay.draw = function() {
//                var projection = this.getProjection();
//
//                function transform(x,y) {
//                    var point = new google.maps.LatLng(y, x);
//                    var tem_point = projection.fromLatLngToDivPixel(point);
//                    this.stream.point(tem_point.x, tem_point.y);
////                    return d3.select(this)
////                            .style("left", (d.x - padding) + "px")
////                            .style("top", (d.y - padding) + "px");
//                }
//
//                var geo_transform = d3.geo.transform({point: transform}),
//                        path = d3.geo.path().projection(geo_transform);
//
//                var feature = g.selectAll("path")
//                        .data(collection.features)
//                        .enter().append("path");
//
//                feature[0].attr("d", path);
//
////                var projection = this.getProjection(),
////                        padding = 10;
////
////                var marker = layer.selectAll("svg")
////                        .data(d3.entries(data))
////                        .each(transform) // update existing markers
////                        .enter().append("svg:svg")
////                        .each(transform)
////                        .attr("class", "marker");
////
////                // Add a circle.
////                marker.append("svg:circle")
////                        .attr("r", 4.5)
////                        .attr("cx", padding)
////                        .attr("cy", padding);
////
////                // Add a label.
////                marker.append("svg:text")
////                        .attr("x", padding + 7)
////                        .attr("y", padding)
////                        .attr("dy", ".31em")
////                        .text(function(d) { return d.key; });
////
////                function transform(d) {
////                    d = new google.maps.LatLng(d.value[1], d.value[0]);
////                    d = projection.fromLatLngToDivPixel(d);
////                    return d3.select(this)
////                            .style("left", (d.x - padding) + "px")
////                            .style("top", (d.y - padding) + "px");
////                }
//            };
//        };
//
//        // Bind our overlay to the map…
//        overlay.setMap(map);
//    });

</script>
</body>
</html>